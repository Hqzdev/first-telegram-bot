from aiogram import Router, F
from aiogram.types import Message
from aiogram.filters import Command
import random
import datetime

router = Router()

# –°–ª—É—á–∞–π–Ω—ã–µ —Ñ–∞–∫—Ç—ã
FACTS = [
    "üåç –ó–µ–º–ª—è ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞, –Ω–∞–∑–≤–∞–Ω–Ω–∞—è –Ω–µ –≤ —á–µ—Å—Ç—å –±–æ–≥–∞.",
    "ü¶í –ñ–∏—Ä–∞—Ñ—ã –º–æ–≥—É—Ç —á–∏—Å—Ç–∏—Ç—å —Å–≤–æ–∏ —É—à–∏ —è–∑—ã–∫–æ–º.",
    "üß† –ú–æ–∑–≥ –Ω–∞ 80% —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≤–æ–¥—ã.",
    "üåà –†–∞–¥—É–≥–∞ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∫—Ä—É–≥–ª–∞—è, –º—ã –≤–∏–¥–∏–º —Ç–æ–ª—å–∫–æ –µ—ë —á–∞—Å—Ç—å.",
    "ü¶à –ê–∫—É–ª—ã —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ —Ä–∞–Ω—å—à–µ, —á–µ–º –¥–µ—Ä–µ–≤—å—è.",
    "üåô –ù–∞ –õ—É–Ω–µ –µ—Å—Ç—å —Å–ª–µ–¥—ã 12 —á–µ–ª–æ–≤–µ–∫.",
    "üêú –ú—É—Ä–∞–≤—å–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–ø—è—Ç.",
    "ü¶ã –ë–∞–±–æ—á–∫–∏ —á—É–≤—Å—Ç–≤—É—é—Ç –≤–∫—É—Å –ª–∞–ø–∫–∞–º–∏.",
    "üêò –°–ª–æ–Ω—ã ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∂–∏–≤–æ—Ç–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –ø—Ä—ã–≥–∞—Ç—å.",
    "üåû –°–≤–µ—Ç –æ—Ç –°–æ–ª–Ω—Ü–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –ó–µ–º–ª–∏ –∑–∞ 8 –º–∏–Ω—É—Ç."
]

@router.message(Command("fact"))
async def random_fact(message: Message):
    fact = random.choice(FACTS)
    await message.reply(fact)

# –ì–æ—Ä–æ—Å–∫–æ–ø
ZODIAC_SIGNS = {
    "–æ–≤–µ–Ω": "‚ôàÔ∏è",
    "—Ç–µ–ª–µ—Ü": "‚ôâÔ∏è",
    "–±–ª–∏–∑–Ω–µ—Ü—ã": "‚ôäÔ∏è",
    "—Ä–∞–∫": "‚ôãÔ∏è",
    "–ª–µ–≤": "‚ôåÔ∏è",
    "–¥–µ–≤–∞": "‚ôçÔ∏è",
    "–≤–µ—Å—ã": "‚ôéÔ∏è",
    "—Å–∫–æ—Ä–ø–∏–æ–Ω": "‚ôèÔ∏è",
    "—Å—Ç—Ä–µ–ª–µ—Ü": "‚ôêÔ∏è",
    "–∫–æ–∑–µ—Ä–æ–≥": "‚ôëÔ∏è",
    "–≤–æ–¥–æ–ª–µ–π": "‚ôíÔ∏è",
    "—Ä—ã–±—ã": "‚ôìÔ∏è"
}

PREDICTIONS = [
    "–°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –Ω–æ–≤—ã—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏–π!",
    "–ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö.",
    "–í–∞—Å –∂–¥–µ—Ç –ø—Ä–∏—è—Ç–Ω—ã–π —Å—é—Ä–ø—Ä–∏–∑.",
    "–•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è –æ–±—â–µ–Ω–∏—è –∏ –Ω–æ–≤—ã—Ö –∑–Ω–∞–∫–æ–º—Å—Ç–≤.",
    "–í–æ–∑–º–æ–∂–Ω—ã –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω—ã.",
    "–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞.",
    "–£–¥–µ–ª–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—é.",
    "–í–∞—Å –∂–¥–µ—Ç —É—Å–ø–µ—Ö –≤ –ª—é–±–æ–≤–Ω—ã—Ö –¥–µ–ª–∞—Ö.",
    "–ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–π –¥–µ–Ω—å –¥–ª—è —Ä–∞–±–æ—Ç—ã –∏ —É—á–µ–±—ã.",
    "–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è —Å —Å–µ–º—å–µ–π."
]

@router.message(Command("horoscope"))
async def horoscope(message: Message):
    try:
        sign = message.text.split()[1].lower()
        if sign in ZODIAC_SIGNS:
            prediction = random.choice(PREDICTIONS)
            emoji = ZODIAC_SIGNS[sign]
            await message.reply(f"{emoji} –ì–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è {sign.capitalize()}:\n\n{prediction}")
        else:
            signs_list = "\n".join([f"{v} {k.capitalize()}" for k, v in ZODIAC_SIGNS.items()])
            await message.reply(f"‚ùå –£–∫–∞–∂–∏—Ç–µ –≤–∞—à –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞:\n\n{signs_list}")
    except IndexError:
        signs_list = "\n".join([f"{v} {k.capitalize()}" for k, v in ZODIAC_SIGNS.items()])
        await message.reply(f"‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç: /horoscope <–∑–Ω–∞–∫>\n\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–Ω–∞–∫–∏:\n{signs_list}")

# –°–ª—É—á–∞–π–Ω—ã–π —Å–æ–≤–µ—Ç
ADVICE = [
    "üí° –ù–∞—á–Ω–∏—Ç–µ –¥–µ–Ω—å —Å —É–ª—ã–±–∫–∏!",
    "üéØ –ü–æ—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ –Ω–æ–≤—É—é —Ü–µ–ª—å.",
    "üìö –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –Ω–æ–≤—É—é –∫–Ω–∏–≥—É.",
    "üèÉ –ó–∞–π–º–∏—Ç–µ—Å—å —Å–ø–æ—Ä—Ç–æ–º.",
    "üé® –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ.",
    "üí™ –ù–µ —Å–¥–∞–≤–∞–π—Ç–µ—Å—å, —É –≤–∞—Å –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è!",
    "üåü –í–µ—Ä—å—Ç–µ –≤ —Å–µ–±—è.",
    "ü§ù –ü–æ–º–æ–≥–∏—Ç–µ –∫–æ–º—É-–Ω–∏–±—É–¥—å —Å–µ–≥–æ–¥–Ω—è.",
    "üßò –ù–∞–π–¥–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏.",
    "‚úçÔ∏è –ó–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–∏ –º—ã—Å–ª–∏ –≤ –¥–Ω–µ–≤–Ω–∏–∫."
]

@router.message(Command("advice"))
async def random_advice(message: Message):
    advice = random.choice(ADVICE)
    await message.reply(advice)

# –°–ª—É—á–∞–π–Ω–∞—è —à—É—Ç–∫–∞
JOKES = [
    "üòÑ –ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –ø—É—Ç–∞—é—Ç –•—ç–ª–ª–æ—É–∏–Ω –∏ –†–æ–∂–¥–µ—Å—Ç–≤–æ? –ü–æ—Ç–æ–º—É —á—Ç–æ 31 OCT = 25 DEC",
    "üòÖ –ö–∞–∫–æ–π —Å–∞–º—ã–π –ª—é–±–∏–º—ã–π –Ω–∞–ø–∏—Ç–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞? Java!",
    "üòÇ –ß—Ç–æ —Å–∫–∞–∑–∞–ª HTML CSS? –¢—ã —Ç–∞–∫–æ–π —Å—Ç–∏–ª—å–Ω—ã–π!",
    "ü§£ –ü–æ—á–µ–º—É Python –Ω–µ –Ω–æ—Å–∏—Ç –æ—á–∫–∏? –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –Ω–µ –° Sharp!",
    "üòÜ –ö–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –±–æ—Ç–∞–Ω–∏–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–π —Å–∞–¥? –ú–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤!",
    "üòÑ –ß—Ç–æ —Å–∫–∞–∑–∞–ª –æ–¥–∏–Ω –±–∞–π—Ç –¥—Ä—É–≥–æ–º—É –±–∞–π—Ç—É? –í—Å—Ç—Ä–µ—Ç–∏–º—Å—è –≤ –ø–æ—Ä—Ç—É!",
    "üòÖ –ü–æ—á–µ–º—É –∫–æ–º–ø—å—é—Ç–µ—Ä —É—Å—Ç–∞–ª? –ü–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–µ–≥–æ –±—ã–ª–∞ —Ç—è–∂–µ–ª–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö!",
    "üòÇ –ß—Ç–æ —Å–∫–∞–∑–∞–ª —Å–µ—Ä–≤–µ—Ä –∫–ª–∏–µ–Ω—Ç—É? –û—Ç–≤–µ—Ç: 200 –û–ö!",
    "ü§£ –ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≥—Ä—É–ø–ø–∞ –∏–∑ 8 –±–∏—Ç, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ? –ë–∞–π—Ç–æ–≤–∞—è –±–∞–Ω–¥–∞!",
    "üòÜ –ß—Ç–æ –æ–±—â–µ–≥–æ –º–µ–∂–¥—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–º –∏ –ø–æ—ç—Ç–æ–º? –û–±–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç—Ä–æ–∫–∏!"
]

@router.message(Command("joke"))
async def random_joke(message: Message):
    joke = random.choice(JOKES)
    await message.reply(joke)

# –ö–æ–º–ø–ª–∏–º–µ–Ω—Ç
COMPLIMENTS = [
    "‚ú® –í—ã —Å–µ–≥–æ–¥–Ω—è –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ –≤—ã–≥–ª—è–¥–∏—Ç–µ!",
    "üåü –£ –≤–∞—Å –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–∞—è —É–ª—ã–±–∫–∞!",
    "üí´ –í—ã –æ—á–µ–Ω—å —Ç–∞–ª–∞–Ω—Ç–ª–∏–≤—ã!",
    "üåà –° –≤–∞–º–∏ —Ç–∞–∫ –ø—Ä–∏—è—Ç–Ω–æ –æ–±—â–∞—Ç—å—Å—è!",
    "üíù –í—ã –¥–µ–ª–∞–µ—Ç–µ –º–∏—Ä –ª—É—á—à–µ!",
    "üéØ –£ –≤–∞—Å –æ—Ç–ª–∏—á–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞!",
    "üå∫ –í—ã –∏—Å—Ç–æ—á–Ω–∏–∫ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –¥–ª—è –¥—Ä—É–≥–∏—Ö!",
    "üí´ –í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –∑–∞—Ä—è–∂–∞–µ—Ç –ø–æ–∑–∏—Ç–∏–≤–æ–º!",
    "üåü –í—ã —É–º–µ–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ–¥—Ö–æ–¥ –∫ –ª—é–¥—è–º!",
    "‚ú® –í—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ —É–º–Ω—ã –∏ –ø—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω—ã!"
]

@router.message(Command("compliment"))
async def send_compliment(message: Message):
    compliment = random.choice(COMPLIMENTS)
    await message.reply(compliment)

# –¶–∏—Ç–∞—Ç–∞ –¥–Ω—è
QUOTES = [
    "üí≠ ¬´–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–µ–ª–∞—Ç—å –≤–µ–ª–∏–∫–∏–µ –¥–µ–ª–∞ ‚Äî –ª—é–±–∏—Ç—å —Ç–æ, —á—Ç–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ¬ª - –°—Ç–∏–≤ –î–∂–æ–±—Å",
    "üí´ ¬´–ë—É–¥—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å –≤ –º–∏—Ä–µ¬ª - –ú–∞—Ö–∞—Ç–º–∞ –ì–∞–Ω–¥–∏",
    "üåü ¬´–ñ–∏–∑–Ω—å ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ —Å –≤–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –ø–æ–∫–∞ –≤—ã —Å—Ç—Ä–æ–∏—Ç–µ –ø–ª–∞–Ω—ã¬ª - –î–∂–æ–Ω –õ–µ–Ω–Ω–æ–Ω",
    "‚ú® ¬´–£—Å–ø–µ—Ö ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏–¥—Ç–∏ –æ—Ç –Ω–µ—É–¥–∞—á–∏ –∫ –Ω–µ—É–¥–∞—á–µ, –Ω–µ —Ç–µ—Ä—è—è —ç–Ω—Ç—É–∑–∏–∞–∑–º–∞¬ª - –£–∏–Ω—Å—Ç–æ–Ω –ß–µ—Ä—á–∏–ª–ª—å",
    "üí´ ¬´–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –±—É–¥—É—â–µ–µ ‚Äî —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ¬ª - –ü–∏—Ç–µ—Ä –î—Ä—É–∫–µ—Ä",
    "üå† ¬´–ï—Å–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ –º–µ—á—Ç–∞—Ç—å –æ–± —ç—Ç–æ–º, –≤—ã –º–æ–∂–µ—Ç–µ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å¬ª - –£–æ–ª—Ç –î–∏—Å–Ω–µ–π",
    "üí≠ ¬´–ñ–∏–∑–Ω—å –ª–∏–±–æ –æ—Ç–≤–∞–∂–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ, –ª–∏–±–æ –Ω–∏—á–µ–≥–æ¬ª - –•–µ–ª–µ–Ω –ö–µ–ª–ª–µ—Ä",
    "‚ú® ¬´–ö–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî —ç—Ç–æ –Ω–æ–≤—ã–π —à–∞–Ω—Å –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å¬ª - Unknown",
    "üåü ¬´–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∑–¥–Ω–æ –±—ã—Ç—å —Ç–µ–º, –∫–µ–º –≤—ã –º–æ–≥–ª–∏ –±—ã –±—ã—Ç—å¬ª - –î–∂–æ—Ä–¥–∂ –≠–ª–∏–æ—Ç",
    "üí´ ¬´–í–∞—à–µ –≤—Ä–µ–º—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ, –Ω–µ —Ç—Ä–∞—Ç—å—Ç–µ –µ–≥–æ, –∂–∏–≤—è —á—É–∂–æ–π –∂–∏–∑–Ω—å—é¬ª - –°—Ç–∏–≤ –î–∂–æ–±—Å"
]

@router.message(Command("quote"))
async def daily_quote(message: Message):
    quote = random.choice(QUOTES)
    await message.reply(quote)

# –ü–æ–≥–æ–¥–∞ (–∏–º–∏—Ç–∞—Ü–∏—è)
WEATHER_CONDITIONS = [
    "‚òÄÔ∏è –°–æ–ª–Ω–µ—á–Ω–æ",
    "üå§ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",
    "‚òÅÔ∏è –û–±–ª–∞—á–Ω–æ",
    "üåß –î–æ–∂–¥—å",
    "‚õà –ì—Ä–æ–∑–∞",
    "‚ùÑÔ∏è –°–Ω–µ–≥",
    "üå´ –¢—É–º–∞–Ω"
]

@router.message(Command("weather"))
async def weather_forecast(message: Message):
    condition = random.choice(WEATHER_CONDITIONS)
    temp = random.randint(-10, 30)
    humidity = random.randint(30, 90)
    wind = random.randint(0, 20)
    
    forecast = f"""
üå° –ü–æ–≥–æ–¥–∞ —Å–µ–π—á–∞—Å:
{condition}
–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {temp}¬∞C
–í–ª–∞–∂–Ω–æ—Å—Ç—å: {humidity}%
–í–µ—Ç–µ—Ä: {wind} –º/—Å
    """
    await message.reply(forecast)

# –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ
@router.message(Command("random"))
async def random_number(message: Message):
    try:
        args = message.text.split()[1:]
        if len(args) == 2:
            start, end = map(int, args)
            number = random.randint(start, end)
            await message.reply(f"üé≤ –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç {start} –¥–æ {end}: {number}")
        else:
            number = random.randint(1, 100)
            await message.reply(f"üé≤ –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ (1-100): {number}")
    except:
        await message.reply("‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç: /random [–Ω–∞—á–∞–ª–æ] [–∫–æ–Ω–µ—Ü]")

# –í—Ä–µ–º—è
@router.message(Command("time"))
async def current_time(message: Message):
    now = datetime.datetime.now()
    await message.reply(f"‚è∞ –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: {now.strftime('%H:%M:%S')}")

# –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
@router.message(Command("calc"))
async def calculator(message: Message):
    try:
        expression = " ".join(message.text.split()[1:])
        if not expression:
            raise ValueError
            
        # –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
        allowed_chars = set("0123456789+-*/() ")
        if not all(c in allowed_chars for c in expression):
            raise ValueError
            
        result = eval(expression)
        await message.reply(f"üî¢ {expression} = {result}")
    except:
        await message.reply("‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç: /calc <–≤—ã—Ä–∞–∂–µ–Ω–∏–µ>\n–ü—Ä–∏–º–µ—Ä: /calc 2 + 2 * 2") 